<!DOCTYPE html>
<%#Page trace="no"%>

<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/>
   <title>Edytowanie budynku</title>
</head>

<body>
 <%#Code locality="page-global"%>
 <%
    #include "C:\inetpub\wwwroot\czynsze\DbHelper.ch"
    #include "C:\inetpub\wwwroot\czynsze\HTMLWriter.ch"
    #include "C:\inetpub\wwwroot\czynsze\Validation.ch"
 %>

  <!--- Page content goes here --->
   <%
      dbHelper:=DbHelper(): new("localhost", "czynsze")
      validationResult:=Validation(): Building("", ::Params: il_miesz, ::Params: udzial_w_k)

      IF validationResult==""
         SELECT * FROM budynki

         FOR i:=1 to LastRec()
            IF Var2Char(FieldGet(3))==Var2Char(::Params: kod_1)
               exit
            ENDIF

            DbSkip()
         NEXT

         DbUnlockAll()
         FLock()

         FIELD->kod_1:=Val(::Params: kod_1)
         FIELD->il_miesz:=Val(::Params: il_miesz)
         FIELD->sp_rozl:=Val(::Params: sp_rozl)
         FIELD->adres:=::Params: adres
         FIELD->adres_2:=::Params: adres_2
         FIELD->udzial_w_k:=Val(::Params: udzial_w_k)
         FIELD->uwagi_1:=SubStr(::Params: uwagi, 1, 70)
         FIELD->uwagi_2:=SubStr(::Params: uwagi, 71, 70)
         FIELD->uwagi_3:=SubStr(::Params: uwagi, 141, 70)
         FIELD->uwagi_4:=SubStr(::Params: uwagi, 211, 70)
         FIELD->uwagi_5:=SubStr(::Params: uwagi, 281, 70)
         FIELD->uwagi_6:=SubStr(::Params: uwagi, 351, 70)

         ? "Edycja zako"+HTMLWriter(): _n()+"czona <br />"
         ? HTMLWriter(): a("Budynki.cxp", "Powrót")
      ELSE
         ? validationResult
         ? HTMLWriter(): a("javascript: history.back()", "Powr"+HTMLWriter(): _o()+"t")
      ENDIF
   %>

</body>

</html>
